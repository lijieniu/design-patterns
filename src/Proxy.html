<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>ä»£ç†æ¨¡å¼</title>
    <style>
        img {
            width: 100px;
            height: 100px;
            border-radius: 50%;
        }
    </style>
</head>
<body>
    
    <script>
        // ä»£ç†æ¨¡å¼ï¼š
        var Flower = function(name) {
            this.name = name;
        };
        var xiaoming = {
            sendFlower: function(target) {
                var flower = new Flower('ç«ç‘°èŠ±ğŸŒ¹');
                target.receiveFlower(flower);
            }
        }

        var xiaoli = {
            receiveFlower: function(flower) {
                if(A.mode > 60) {
                    A.receiveFlower(flower);
                } 
                
            }
        }

        var A = {
            mode: 50,
            receiveFlower: function(flower) {
                console.log('Aæ”¶åˆ°äº†' + flower.name);
            }
        }

        xiaoming.sendFlower(xiaoli);


        // 1ã€è™šæ‹Ÿä»£ç†ï¼šæŠŠä¸€äº›å¼€é”€å¾ˆå¤§çš„å¯¹è±¡ï¼Œå»¶è¿Ÿåˆ°çœŸæ­£éœ€è¦å®ƒçš„æ—¶å€™æ‰åˆ›å»ºæ‰§è¡Œ
                // 1.1ï¼šå›¾ç‰‡å»¶è¿ŸåŠ è½½
        var myImage = (function() {
            var imgNode = document.createElement('img');
            document.body.appendChild(imgNode);

            return {
                setSrc: function(src) {
                    imgNode.src = src;
                }
            }
        })();
        // ä½¿ç”¨ä»£ç†
        var proxyImage = (function() {
            var img = new Image();
            img.onload = function() {
                console.log('çœŸæ­£çš„å›¾ç‰‡åŠ è½½');
                myImage.setSrc(this.src);
            };
            return {
                setSrc: function(src) {
                    console.log('å…ˆåŠ è½½äº†loadingå›¾');
                    myImage.setSrc('./img/default-avatar.png'); // loadingå›¾
                    img.src = src;
                }
            }
        })();

        proxyImage.setSrc('https://s.wandougongzhu.cn/s/88/_75b89e.png');


                // 1.2ï¼šåˆå¹¶httpè¯·æ±‚(æ¯”å¦‚é”™è¯¯æ—¥å¿—çš„å‘é€)
        var files = [];
        for(var i = 0; i < 10; i++) {
            var obj = {};
            obj.filename = 'file' + i;
            files.push(obj);
        }
        var uploadFile = function(filename) {
            console.log('æ­£åœ¨ä¸Šä¼ æ–‡ä»¶' + filename);
        }
        var proxyUploadFile = (function() {
            var cache = [],
                timer;
            return function(filename) {
                cache.push(filename);
                if(timer) {
                    return;
                }
                timer = setTimeout(function() {
                    uploadFile(cache.join(','));
                    clearTimeout(timer);
                    timer = null;
                    cache.length = 0;
                }, 2000);
            }

        })();
        for(var j = 0; j < 10; j++) {
            proxyUploadFile(files[j].filename);
        }
    
        // 2ã€ç¼“å­˜ä»£ç†ï¼šä¸ºä¸€äº›å¼€é”€å¤§çš„è¿ç®—ç»“æœæä¾›æš‚æ—¶çš„å­˜å‚¨ï¼Œä¸‹æ¬¡è¿ç®—çš„æ—¶å€™ï¼Œå¦‚æœä¼ è¿‡æ¥çš„å‚æ•°å’Œä¹‹å‰çš„ä¸€è‡´
        //     åˆ™å¯ä»¥è¿”å›å­˜å‚¨çš„ç»“æœ
        var mult = function() {
            var a = 1;
            for(var i = 0; i < arguments.length; i++) {
                a = a * arguments[i];
            }
            return a;
        }
        mult(2, 3, 4);

        var proxyMult = (function() {
            var cache = {};
            return function() {
                var args = Array.prototype.join.call(arguments, ',');
                if(args in cache) {
                    console.log(args + 'çš„ä¹˜ç§¯ä¸º: ' + cache[args]);
                    return cache[args];
                }
                return cache[args] = mult.apply(this, arguments);
            }
        })();
        var result2 = proxyMult(2, 3, 4, 5, 6, 7);
        proxyMult(2, 3, 4, 5, 6, 7);
        proxyMult(2, 3, 4, 5, 6, 7);

        // ä»£ç†æ¨¡å¼ä¼˜ç‚¹ï¼š
        //     å°†ä»£ç†å¯¹è±¡ä¸è¢«ä»£ç†å¯¹è±¡åˆ†ç¦»ï¼Œé™ä½äº†ç³»ç»Ÿçš„è€¦åˆåº¦ï¼›ä½œä¸ºä¸€ä¸ªä¸­ä»‹å¯ä»¥ä¿æŠ¤ç›®æ ‡å¯¹è±¡ï¼›å¯¹ç›®æ ‡å¯¹è±¡è°ƒç”¨ä¹‹å‰
        //     åšä¸€äº›å…¶ä»–çš„æ“ä½œã€‚
        //        ç¼ºç‚¹ï¼šå¢åŠ äº†ç³»ç»Ÿçš„å¤æ‚åº¦ã€‚
    </script>
</body>
</html>