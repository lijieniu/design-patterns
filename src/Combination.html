
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>设计模式-组合模式</title>
    <style>
        
    </style>
</head>
<body>
    <script>
        // 将对象组合成树形结构以表示“部分-整体”的层次结构。使单个对象和组合对象的使用具有一致性。
        // 同时处理简单对象和由简单对象组成的复杂对象，这些简单对象和复杂对象组成树形结构，在客户端对其进行处理的时候要保持一致性。
        // 应用场景：对象具有明显的层次结构并且想要统一的使用它们，比如文件夹目录目录、点餐时的套餐、DOM树
        var MacroCommand = function() {
            return {
                commandList: [],
                add: function(command) {
                    this.commandList.push(command);
                },
                execute: function() {
                    for(var i = 0, command; command = this.commandList[i++];) {
                        command.execute();
                    }
                }
            }
        }
        var closeDoorCommand = {
            execute: function() {
                console.log('关门');
            }
        }
        var openTVCommand = {
            execute: function() {
                console.log('打开电视');
            }
        }
        var macroCommand = MacroCommand();
        macroCommand.add(closeDoorCommand);
        macroCommand.add(openTVCommand);
        macroCommand.execute(); // 组合模式的关键

        console.log('----------华丽的分割线1-----------');

        // 增加命令
        var openLigthCommand = {
            execute: function() {
                console.log('开灯');
            }
        }
        macroCommand.add(openLigthCommand);
        macroCommand.execute();

        console.log('----------华丽的分割线2-----------');
        var macroCommand2 = MacroCommand();
        macroCommand2.add(openTVCommand);
        var leafMacroCommand = MacroCommand();
        leafacroCommand.add(closeDoorCommand);
        macroCommand2.add(leafMacroCommand);
        macroCommand2.execute();
    </script>
</body>
</html>